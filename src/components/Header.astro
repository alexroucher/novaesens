---
// Détecter la page active côté serveur
const currentPath = Astro.url.pathname;
---

<header class="header">
  <div class="header-container">
    <div class="logo">
      <a href="/" aria-label="Retour à l'accueil - Novaesens" title="Accueil">
        <img src="/images/novaesens-logo-min.png" alt="Novaesens - Expert CIR, CII et JEI" />
      </a>
    </div>
    
    <nav class="main-nav" aria-label="Navigation principale">
      <ul class="nav-list">
        <li><a href="/" class="nav-link" data-page="home" class:list={[{ active: currentPath === '/' }]}>Accueil</a></li>
        <li><a href="/cir-cii-jei" class="nav-link" data-page="cir" class:list={[{ active: currentPath.startsWith('/cir-cii-jei') }]}>CIR, CII et JEI</a></li>
        <li><a href="/a-propos" class="nav-link" data-page="about" class:list={[{ active: currentPath.startsWith('/a-propos') }]}>Mon expertise</a></li>
      </ul>
    </nav>

    <a href="/contact" class="header-cta desktop-only">
      Demander un audit
      <svg xmlns="https://www.w3.org/2000/svg" width="36" height="35" viewBox="0 0 36 35" fill="none">
        <path d="M24.3378 18.2963C24.4933 18.1338 24.6152 17.9422 24.6965 17.7325C24.8674 17.3166 24.8674 16.8501 24.6965 16.4342C24.6152 16.2245 24.4933 16.0329 24.3378 15.8704L19.2128 10.7454C18.8911 10.4237 18.4548 10.243 17.9998 10.243C17.5449 10.243 17.1086 10.4237 16.7869 10.7454C16.4652 11.0671 16.2845 11.5034 16.2845 11.9583C16.2845 12.4133 16.4652 12.8496 16.7869 13.1713L19.0078 15.375H12.8748C12.4218 15.375 11.9872 15.555 11.6669 15.8754C11.3465 16.1957 11.1665 16.6303 11.1665 17.0833C11.1665 17.5364 11.3465 17.9709 11.6669 18.2913C11.9872 18.6117 12.4218 18.7917 12.8748 18.7917H19.0078L16.7869 20.9954C16.6268 21.1542 16.4997 21.3432 16.413 21.5514C16.3263 21.7595 16.2816 21.9828 16.2816 22.2083C16.2816 22.4339 16.3263 22.6571 16.413 22.8653C16.4997 23.0735 16.6268 23.2624 16.7869 23.4213C16.9457 23.5814 17.1347 23.7085 17.3429 23.7952C17.551 23.8819 17.7743 23.9266 17.9998 23.9266C18.2254 23.9266 18.4487 23.8819 18.6568 23.7952C18.865 23.7085 19.0539 23.5814 19.2128 23.4213L24.3378 18.2963ZM35.0832 17.0833C35.0832 13.7046 34.0813 10.4017 32.2041 7.59235C30.327 4.78301 27.6589 2.5934 24.5374 1.3004C21.4158 0.00740194 17.9809 -0.330905 14.6671 0.328259C11.3532 0.987423 8.30925 2.61445 5.9201 5.0036C3.53096 7.39275 1.90393 10.4367 1.24476 13.7505C0.585599 17.0644 0.923906 20.4993 2.2169 23.6208C3.5099 26.7424 5.69951 29.4105 8.50885 31.2876C11.3182 33.1648 14.6211 34.1667 17.9998 34.1667C22.5306 34.1667 26.8758 32.3668 30.0796 29.1631C33.2833 25.9593 35.0832 21.6141 35.0832 17.0833V17.0833ZM4.33318 17.0833C4.33318 14.3803 5.13471 11.738 6.63643 9.49055C8.13814 7.24308 10.2726 5.49139 12.7698 4.45699C15.2671 3.42259 18.015 3.15194 20.6661 3.67928C23.3172 4.20661 25.7523 5.50823 27.6636 7.41955C29.575 9.33087 30.8766 11.766 31.4039 14.4171C31.9312 17.0682 31.6606 19.8161 30.6262 22.3133C29.5918 24.8106 27.8401 26.945 25.5926 28.4468C23.3452 29.9485 20.7029 30.75 17.9998 30.75C14.3752 30.75 10.899 29.3101 8.33605 26.7471C5.77305 24.1841 4.33318 20.708 4.33318 17.0833V17.0833Z" fill="#F5F7AE"/>
      </svg>
    </a>

    <button class="menu-toggle mobile-only" aria-label="Ouvrir le menu de navigation" aria-expanded="false" aria-controls="mobile-menu">
      <span class="hamburger"></span>
    </button>
  </div>

  <!-- Bottom Sheet -->
  <div class="bottom-sheet" id="mobile-menu" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="bottom-sheet-content">
      <button class="close-menu" aria-label="Fermer le menu">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M19 6.41L17.59 5L12 10.59L6.41 5L5 6.41L10.59 12L5 17.59L6.41 19L12 13.41L17.59 19L19 17.59L13.41 12L19 6.41Z" fill="#2E3030"/>
        </svg>
      </button>
      
      <nav class="mobile-nav">
        <ul class="mobile-nav-list">
          <li>
            <a href="/">
              <svg class="chevron-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M6 4L10 8L6 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Accueil
            </a>
            <p class="mobile-nav-subtitle">Pourquoi et comment je vous accompagne</p>
          </li>
          <li>
            <a href="/cir-cii-jei">
              <svg class="chevron-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M6 4L10 8L6 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              CIR, CII et JEI
            </a>
            <p class="mobile-nav-subtitle">Je vous dit tout sur ces dispositifs</p>
          </li>
          <li>
            <a href="/a-propos">
              <svg class="chevron-icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
                <path d="M6 4L10 8L6 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
              </svg>
              Mon expertise
            </a>
            <p class="mobile-nav-subtitle">Connaissons-nous pour bien travailler ensemble</p>
          </li>
        </ul>
      </nav>

      <a href="/contact" class="header-cta mobile-cta">
        Demander un audit
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none">
          <path d="M12 4L10.59 5.41L16.17 11H4V13H16.17L10.59 18.59L12 20L20 12L12 4Z" fill="white"/>
        </svg>
      </a>
    </div>
  </div>
</header>

<style>
  .header {
    width: 100%;
    padding: 16px 32px;
    position: fixed;
    top: 0;
    left: 0;
    z-index: 100;
  }

  .header-container {
    max-width: 1440px;
    margin: 0 auto;
    background: white;
    border-radius: 100px;
    padding: 24px 40px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    box-shadow: 0px 4px 14px 0px rgba(54, 55, 55, 0.25);
  }

  .logo {
    display: flex;
    align-items: center;
    gap: 12px;
    height: 40px;
  }

  .logo-text {
    font-family: 'Jost', sans-serif;
    font-size: var(--font-size-24);
    font-weight: 500;
    color: var(--novablack);
  }

  .main-nav {
    flex: 1;
    display: flex;
    justify-content: center;
  }

  .nav-list {
    display: flex;
    gap: 48px;
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .nav-list a {
    font-family: 'Jost', sans-serif;
    font-size: var(--font-size-16);
    font-weight: 500;
    color: var(--novablack);
    text-decoration: none;
    position: relative;
    display: inline-block;
    padding: 4px 0;
  }

  /* Trait commun pour hover et active */
  .nav-list a::after {
    content: '';
    position: absolute;
    bottom: -4px;
    left: 0;
    width: 20px;
    height: 2px;
    background-color: var(--novablack);
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s ease;
  }

  /* Animation au hover */
  .nav-list a:hover::after {
    transform: scaleX(1);
  }

  /* Trait toujours visible sur la page active */
  .nav-list a.active::after {
    transform: scaleX(1);
  }

  .header-cta {
    display: flex;
    width: 240px;
    height: 53px;
    padding: 0px 16px;
    justify-content: center;
    align-items: center;
    gap: 10px;
    flex-shrink: 0;
    border-radius: 10px;
    border: 1px solid var(--Novaesens---primari, #2E3030);
    background: var(--Nova-design-black, #2E3030);
    color: white;
    font-family: 'Jost', sans-serif;
    font-size: var(--font-size-16);
    cursor: pointer;
    transition: all 0.2s ease;
    text-decoration: none;
  }

  .header-cta:hover {
    opacity: 0.9;
  }

  /* Menu hamburger */
  .menu-toggle {
    display: none;
    background: none;
    border: none;
    padding: 10px;
    cursor: pointer;
  }

  .hamburger {
    display: block;
    width: 24px;
    height: 2px;
    background: var(--novablack);
    position: relative;
    transition: all 0.3s ease;
  }

  .hamburger::before,
  .hamburger::after {
    content: '';
    position: absolute;
    width: 24px;
    height: 2px;
    background: var(--novablack);
    transition: all 0.3s ease;
  }

  .hamburger::before {
    top: -6px;
  }

  .hamburger::after {
    bottom: -6px;
  }

  /* Bottom Sheet */
  .bottom-sheet {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0, 0, 0, 0.5);
    z-index: 99;
    opacity: 0;
    visibility: hidden;
    transition: all 0.3s ease;
  }

  .bottom-sheet-content {
    position: absolute;
    bottom: 0;
    left: 0;
    width: 100%;
    background: linear-gradient(180deg, #FAFAFA 0%, #FAFAFA 100%);
    padding: 32px;
    border-radius: 20px 20px 0 0;
    transform: translateY(100%);
    transition: transform 0.3s ease;
  }

  .close-menu {
    position: absolute;
    top: 24px;
    right: 24px;
    background: none;
    border: none;
    padding: 8px;
    cursor: pointer;
  }

  .mobile-nav {
    margin-top: 48px;
  }

  .mobile-nav-list {
    list-style: none;
    padding: 0;
    margin: 0;
  }

  .mobile-nav-list li {
    margin-bottom: 32px;
  }

  .mobile-nav-list a {
    font-family: 'Jost', sans-serif;
    font-size: var(--font-size-18);
    font-weight: 500;
    color: var(--novablack);
    text-decoration: none;
    transition: color 0.2s ease;
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 4px;
  }

  .chevron-icon {
    flex-shrink: 0;
    color: var(--novablack);
  }

  .mobile-nav-subtitle {
    font-family: 'Jost', sans-serif;
    font-size: var(--font-size-14);
    color: var(--novablack);
    opacity: 0.7;
    margin: 0;
    line-height: 1.4;
    margin-left: 28px;
  }

  .mobile-cta {
    width: 100%;
    margin-top: 32px;
  }

  /* Responsive */
  @media (max-width: 1000px) {
    .header {
      padding: 12px 16px;
    }

    .header-container {
      padding: 16px 24px;
    }

    .logo img {
      max-width: 180px;
      height: auto;
    }

    .desktop-only {
      display: none;
    }

    .mobile-only {
      display: block;
    }

    .main-nav {
      display: none;
    }

    .menu-toggle {
      display: block;
    }

    .bottom-sheet {
      display: block;
    }

    /* Classes pour l'animation du menu - utilisées par le JavaScript */
    body.menu-open {
      overflow: hidden;
    }

    body.menu-open .bottom-sheet {
      opacity: 1;
      visibility: visible;
    }

    body.menu-open .bottom-sheet-content {
      transform: translateY(0);
    }

    body.menu-open .hamburger {
      background: transparent;
    }

    body.menu-open .hamburger::before {
      transform: rotate(45deg);
      top: 0;
    }

    body.menu-open .hamburger::after {
      transform: rotate(-45deg);
      bottom: 0;
    }
  }

  @media (min-width: 1000px) {
    .mobile-only {
      display: none;
    }

    .desktop-only {
      display: flex;
    }

  }

</style> 